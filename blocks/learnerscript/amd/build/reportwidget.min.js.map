{"version":3,"sources":["../src/reportwidget.js"],"names":["define","$","Ajax","report","smartfilter","reportwidget","DashboardWidgets","args","self","container","filterdata","FilterData","reportid","show","each","data","blockinstance","val","reportinstance","reporttype","params","extend","CreateDashboardwidget","instanceid","DashboardTiles","ls_fstartdate","ls_fenddate","courseid","CreateDashboardTile","blockinstanceid","html","filters","urlParam","name","results","RegExp","exec","window","location","href","dashboardurl","filter_courses","promise","call","methodname","JSON","stringify","loading","done","parse","tabledata","plot","error","messages","length","require","generate_plotgraph","key","value","head","categorydata","k","v","isNaN","append","styletilescolour","css","console","log","reportdashboard","columnDefs","removeClass","addClass","selectreport","attr","singleplot","action","link","basicparams","basicparamsdata","indexOf","BasicparamsData","prepend","M","util","image_url","chartdata","parseJSON","emptydata","tdata","document","ajaxStop","remove","reportname","ReportDatatable","fail"],"mappings":"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","sourcesContent":["define(['jquery',\r\n        'core/ajax',\r\n        'block_learnerscript/report',\r\n        'block_learnerscript/smartfilter'\r\n    ], function($, Ajax, report, smartfilter) {\r\n    return reportwidget = {\r\n        /**\r\n         * Creates dashboard widgets for configured widgets of dashboard depends on type\r\n         * @param object args reportcontainer\r\n         * @return Creates and render widgets with given congurations and locations\r\n         */\r\n        DashboardWidgets: function(args) {\r\n            var self = this;\r\n            var args = args || {\r\n                container: '.report_dashboard_container'\r\n            };\r\n            var filterdata = smartfilter.FilterData(args.reportid);\r\n            $('.loader').show();\r\n            $(args.container).each(function() {\r\n                var reporttype;\r\n                var reportid = $(this).data('reportid');\r\n                var blockinstance = $(this).data('blockinstance');\r\n                if ($(this).val() != '') {\r\n                    var blockinstance = $(\"#reportcontainer\" + reportinstance).data('blockinstance');\r\n                    args.reporttype = $(\"#reporttype_\" + blockinstance + \"  :selected\").val();\r\n                    var params = {\r\n                        reportid: reportid,\r\n                        reporttype: args.reporttype\r\n                    };\r\n                    $.extend(params, filterdata);\r\n                    self.CreateDashboardwidget(params);\r\n                    return false;\r\n                }\r\n                args.reporttype = $(\"#reporttype_\" + blockinstance + \"  :selected\").val();\r\n\r\n                if (typeof(args.reporttype) == 'undefined') {\r\n                    args.reporttype = $(this).data('reporttype');\r\n                }\r\n\r\n                self.CreateDashboardwidget({\r\n                    reportid: reportid,\r\n                    reporttype: args.reporttype,\r\n                    instanceid: blockinstance\r\n                });\r\n            });\r\n        },\r\n        DashboardTiles: function() {\r\n            var self = this;\r\n            ls_fstartdate = $('#ls_fstartdate').val();\r\n            ls_fenddate = $('#ls_fenddate').val();\r\n            var courseid = $('#ls_courseid').val();\r\n            $(\".tiles_information\").each(function() {\r\n                self.CreateDashboardTile({\r\n                    blockinstanceid: $(this).data('instanceid'),\r\n                    reportid: $(this).data('reportid'),\r\n                    reporttype: $(this).data('reporttype'),\r\n                    ls_fstartdate: ls_fstartdate,\r\n                    ls_fenddate: ls_fenddate,\r\n                    courseid: courseid\r\n                })\r\n            });\r\n        },\r\n        CreateDashboardTile: function(args) {\r\n            var self = this;\r\n            $(\"#inst\" + args.blockinstanceid + \" .tiles_information table tr\").html(\"\");\r\n            var reportinstance = args.blockinstanceid;\r\n            var filters = {};\r\n            filters['ls_fstartdate'] = $('#ls_fstartdate'+args.blockinstanceid).val();\r\n            filters['ls_fenddate'] = $('#ls_fenddate'+args.blockinstanceid).val();\r\n\r\n            $.urlParam = function(name){\r\n                var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);\r\n                if (results === null || results == ' ' ){\r\n                    return null;\r\n                } else {\r\n                    return results[1] || 0;\r\n                }\r\n            }\r\n            var dashboardurl = $.urlParam('dashboardurl');\r\n            if (typeof filters['filter_courses'] == 'undefined') {\r\n                var filter_courses = $('.report_courses').val();\r\n                if (dashboardurl == 'Course') {\r\n                    args.courseid = filter_courses;\r\n                }\r\n                if (filter_courses != 1) {\r\n                    filters['filter_courses'] = filter_courses;\r\n                }\r\n            }\r\n            \r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_generate_plotgraph',\r\n                args: {\r\n                    instanceid: args.blockinstanceid,\r\n                    reportid: args.reportid,\r\n                    courseid: args.courseid,\r\n                    filters: JSON.stringify(filters),\r\n                    // filter_courseid: args.courseid,\r\n                    reporttype: args.reporttype\r\n                },\r\n                loading: '#reportloading_' + args.blockinstanceid\r\n            }]);\r\n            promise[0].done(function(data) {\r\n                data = JSON.parse(data);\r\n                var heads = [];\r\n                var tabledata = [];\r\n                if (args.reporttype != 'table') {\r\n                    // if (typeof args.ls_fstartdate == 'undefined') {\r\n                        $.extend(data.plot, args);\r\n                        data.plot.container = \"#plotreportcontainer\" + reportinstance;\r\n                        if (data.plot.error === true) {\r\n                            $('#plotreportcontainer' + reportinstance).html('<p class=\"alert alert-warning\">' + data.plot.messages + '</p>');\r\n                        } else {\r\n                            if (data.plot.data.length == 0) {\r\n                                $(data.plot.container).html(\"<div class='alert alert-info'>Data Not Available.</div>\");\r\n                            } else {\r\n                                data.plot.reportinstance = reportinstance;\r\n                                require(['block_learnerscript/report'], function(report) {\r\n                                    report.generate_plotgraph(data.plot);\r\n                                });\r\n                            }\r\n                        }\r\n                    // }\r\n                } else {\r\n                    if (typeof data.plot != 'undefined') {\r\n                        if (data.plot.data.length > 0) {\r\n                            $(data.plot.data).each(function(key, value) {\r\n                                heads = [];\r\n                                tabledata = [];\r\n                                heads = value.head;\r\n                                tabledata = value.data;\r\n                            });\r\n                            $(data.plot.categorydata).each(function(k, v) {\r\n                                if (data.plot.categorydata.length == 1) {\r\n                                    if (!isNaN(tabledata[0][k])) {\r\n                                        $(\"#inst\" + args.blockinstanceid + \" .tiles_information table tr\").append('<td><h1 ' + args.styletilescolour + '> ' + tabledata[0][k] + ' </h1></td>');\r\n                                    } else {\r\n                                        $(\"#inst\" + args.blockinstanceid + \" .tiles_information table tr\").append('<td><h6 ' + args.styletilescolour + '> ' + tabledata[0][k] + ' </h6></td>');\r\n                                    }\r\n                                } else {\r\n                                    $(\"#inst\" + args.blockinstanceid + \" .tiles_information table tr\").append('<td>' + v + ' : <b> ' + tabledata[k] + ' </b></td>');\r\n                                }\r\n                            });\r\n                        } else {\r\n                                $(\"#inst\" + args.blockinstanceid + \" .tiles_information table tr\").html(\"<div class='alert alert-info'> No Data Available.</div>\");\r\n                                $(\"#inst\" + args.blockinstanceid + \" .dashboard_tiles\").css('color', '#4B4B4B');\r\n                                // $(\"#inst\" + args.blockinstanceid + \" .tiles_information\").html(\"<div class='alert alert-info'> No Data Available.</div>\");\r\n                        }\r\n                        $(\"#reportloading_\" + args.blockinstanceid).css('display', 'none');\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * Creates single dashboard widget for requested report and type\r\n         * @param object args reportid and reporttype\r\n         * @return Creates report widget depends on type table,pie chart etc...\r\n         */\r\n        CreateDashboardwidget: function(args) {\r\n            var self = this;\r\n            console.log(args);\r\n            if(args.reportdashboard == false){\r\n                args.instanceid = '';\r\n            }\r\n            var reportinstance = args.instanceid || args.reportid;\r\n            args.filters = smartfilter.FilterData(reportinstance);\r\n            args.columnDefs = '';\r\n            args.filters['ls_fstartdate'] = $('#ls_fstartdate'+args.instanceid).val();\r\n            args.filters['ls_fenddate'] = $('#ls_fenddate'+args.instanceid).val();\r\n            if (typeof args.filters['filter_courses'] == 'undefined') {\r\n                var filter_courses = $('.report_courses').val();\r\n                if (filter_courses != 1) {\r\n                    args.filters['filter_courses'] = filter_courses;\r\n                }\r\n            }\r\n            if (args.reporttype == 'table') {\r\n            } else {\r\n                $('.plotgraphcontainer').removeClass('hide').addClass('show');\r\n            }\r\n            if (args.selectreport) {\r\n                $(\"#reportcontainer\" + reportinstance).attr('data-reporttype', args.singleplot);\r\n                $(\"#plotreportcontainer\" + reportinstance).attr('data-reporttype', args.singleplot);\r\n                delete args.selectreport;\r\n            }\r\n\r\n            args.filters = JSON.stringify(args.filters);\r\n\r\n            args.action = 'generate_plotgraph';\r\n            $('.download_menu' + reportinstance + ' li a').each(function(index) {\r\n                var link = $(this).attr('href');\r\n                if (typeof args.basicparams != 'undefined') {\r\n                    var basicparamsdata = JSON.parse(args.basicparams);\r\n                    $.each(basicparamsdata, function(key, value) {\r\n                        if (key.indexOf('filter_') == 0) {\r\n                            link += '&' + key + '=' + value;\r\n                        }\r\n                    });\r\n                }\r\n                if (typeof(args.filters) != 'undefined') {\r\n                    var filters = JSON.parse(args.filters);\r\n                    $.each(filters, function(key, value) {\r\n                        if (key.indexOf('filter_') == 0) {\r\n                            link += '&' + key + '=' + value;\r\n                        }\r\n                        if(key.indexOf('ls_') == 0) {\r\n                            link += '&' + key + '=' + value;\r\n                        }\r\n                    });\r\n                }\r\n                $(this).attr('href', link);\r\n            });\r\n            args.basicparams = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(reportinstance));\r\n            if (typeof args.reportdashboard != 'undefined' && typeof args.reporttype != 'undefined') {\r\n                $(\"#reportcontainer\" + reportinstance).html(\"\");\r\n                $(\"#plotreportcontainer\" + reportinstance).html(\"\");\r\n            } else {\r\n                if (typeof args.reportdashboard != 'undefined' && args.reporttype == 'table') {\r\n                    $(\"#reportcontainer\" + reportinstance).html(\"\");\r\n                } else {\r\n                    $(\"#plotreportcontainer\" + reportinstance).html(\"\");\r\n                }\r\n            }\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_generate_plotgraph',\r\n                args: args,\r\n                loading: '#reportloading_' + args.reportid\r\n            }]);\r\n            if ($(\"#reportloadingimage\").length <= 0) {\r\n                if (args.reporttype == 'table') {\r\n                    $(\"#reportcontainer\" + args.reportid).prepend('<img src=\"' + M.util.image_url('loading', 'block_learnerscript') + '\" id=\"reportloadingimage\" />');\r\n                } else {\r\n                    $(\"#plotreportcontainer\" + args.reportid).prepend('<img src=\"' + M.util.image_url('loading', 'block_learnerscript') + '\" id=\"reportloadingimage\" />');\r\n                }\r\n            }\r\n            promise[0].done(function(chartdata) {\r\n                chartdata = $.parseJSON(chartdata);\r\n                var reporttype = chartdata.reporttype || args.reporttype;\r\n                if (reporttype == 'table') {\r\n                    if (typeof(chartdata.data) == 'undefined' && chartdata.emptydata) {\r\n                        if (!$('#reporttable_' + args.reportid).length) {\r\n                            $(\"#reportcontainer\" + reportinstance).html(chartdata.tdata);\r\n                        }\r\n                        $(document).ajaxStop(function() {\r\n                            $(\"#reportloadingimage\").remove();\r\n                        });\r\n                        args.reportname = chartdata.reportname;\r\n                        require(['block_learnerscript/report'], function(report) {\r\n                            report.ReportDatatable(args);\r\n                        });\r\n                    } else {\r\n                        if (!$('#reporttable_' + args.reportid).length) {\r\n                            $(\"#reportcontainer\" + reportinstance).html(chartdata.tdata);\r\n                        }\r\n                        $(document).ajaxStop(function() {\r\n                            $(\"#reportloadingimage\").remove();\r\n                        });\r\n                        args.columnDefs = chartdata.columnDefs;\r\n                        args.data = chartdata.data;\r\n                        args.reportname = chartdata.reportname;\r\n                        require(['block_learnerscript/report'], function(report) {\r\n                            report.ReportDatatable(args);\r\n                        });\r\n                    }\r\n                } else {\r\n                    $.extend(chartdata.plot, args);\r\n                    chartdata.plot.container = \"#plotreportcontainer\" + reportinstance;\r\n                    $(document).ajaxStop(function() {\r\n                        $(\"#reportloadingimage\").remove();\r\n                    });\r\n                    if (chartdata.plot.error === true) {\r\n                        $('#plotreportcontainer' + reportinstance).html('<p class=\"alert alert-warning\">' + chartdata.plot.messages + '</p>');\r\n                    } else {\r\n                        if (chartdata.plot.data && chartdata.plot.data.length > 0) {\r\n                            chartdata.plot.reportinstance = reportinstance;\r\n                            $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(chartdata.reportname);\r\n                            args.reportname = chartdata.reportname;                            \r\n                            require(['block_learnerscript/report'], function(report) {\r\n                                report.generate_plotgraph(chartdata.plot);\r\n                            });\r\n                        } else {\r\n                            $(chartdata.plot.container).html('<p class=\"alert alert-warning\">No data available</p>');\r\n                        }\r\n                    }\r\n                }\r\n            }).fail(function(ex) {\r\n                // do something with the exception\r\n            });\r\n        }\r\n    }\r\n});\r\n"],"file":"reportwidget.min.js"}