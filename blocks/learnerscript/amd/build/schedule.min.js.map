{"version":3,"sources":["../src/schedule.js"],"names":["define","$","Ajax","ajax","Event","select2","report","Str","schedule","schreportform","args","promise","call","methodname","reportid","instance","instanceid","done","response","parseJSON","append","title_img","M","util","image_url","dlg","dialog","resizable","autoOpen","width","title","modal","appendTo","position","my","at","of","open","closest","find","removeClass","html","Closebutton","parent","attr","close","remove","SelectRoleUsers","schformvalidation","form","reqclass","fail","ScheduledTimings","theme","dataTable","cfg","wwwroot","ViewSchUsersTable","action","scheduleid","schuserslist","document","getElementById","addEventListener","ev","myValidator","validate_scheduled_reports_form","e","window","tinyMCE","triggerSave","preventDefault","self","skipClientValidation","ret","frm","first_focus","each","index","value","element","data","validate_scheduled_reports_form_element","Y","use","Global","fire","core","globalEvents","FORM_ERROR","formid","elementid","focus","escapedName","errFlag","_qfMsg","parentNode","name","nodeName","toUpperCase","valueIdx","i","options","length","selected","qf_errorHandler","event","Events","FORM_FIELD_VALIDATION","trigger","isDefaultPrevented","div","errorSpan","createElement","id","className","insertBefore","firstChild","setAttribute","removeChild","appendChild","createTextNode","substring","substr","linebreak","nextSibling","frequency_schedule","frequency","reportinstance","val","resp","template","manageschusers","get_string","then","selectedroleid","JSON","stringify","bodyattb","addClass","within","hasClass","parentdialog","getroleusers","roles","bullkselectedusers","type","roleid","split","contextlevel","term","total_count","items","fullname","bulkmanageschusers","map","selectedusers","clone","children","tenusers","slice","opt","innerHTML","viewschusers","url","prev","css","addschusers","selschusers","selusers","total","concat","includes","indexOf","splice","not","k","v","d","filter","item","pos","require","helper","Select2Ajax","maximumSelectionLength","rolewiseusers"],"mappings":"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","sourcesContent":["define(['jquery',\r\n    'core/ajax',\r\n    'block_learnerscript/ajax',\r\n    'core/event',\r\n    'block_learnerscript/select2',\r\n    'block_learnerscript/report',\r\n    'core/str'\r\n], function($, Ajax, ajax, Event, select2, report,Str) {\r\n\r\n    return schedule = {\r\n        /**\r\n         * To display scheduled timings for report\r\n         */\r\n        /**\r\n         * Schedule report form in popup in dashboard\r\n         * @param  object args reportid\r\n         * @return Popup with schedule form\r\n         */\r\n        schreportform: function(args) {\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_schreportform',\r\n                args: {\r\n                    // action: 'schreportform',\r\n                    reportid: args.reportid,\r\n                    instance: args.instanceid\r\n                },\r\n                // url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\r\n            }]);\r\n            promise[0].done(function(response) {\r\n                response = $.parseJSON(response);\r\n                $('body').append(\"<div class='schreportform\" + args.instanceid + \"'>\" + response + \"</div>\");\r\n                var title_img = \"<img class='dialog_title_icon' alt='Scheduled Report' src='\" +\r\n                    M.util.image_url(\"schedule_icon\", \"block_learnerscript\") + \"'/>\";\r\n                var dlg = $(\".schreportform\" + args.instanceid).dialog({\r\n                    resizable: true,\r\n                    autoOpen: false,\r\n                    width: \"90%\",\r\n                    title: 'Add schedule report',\r\n                    modal: true,\r\n                    appendTo: \"#inst\" + args.instanceid,\r\n                    position: {\r\n                        my: \"center\",\r\n                        at: \"center\",\r\n                        of: \"#reportcontainer\" + args.instanceid\r\n                    },\r\n                    open: function(event, ui) {\r\n                        $(this).closest(\".ui-dialog\").find(\".ui-dialog-titlebar-close\")\r\n                            .removeClass(\"ui-dialog-titlebar-close\")\r\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        $(this).closest(\".ui-dialog\").find('.ui-dialog-title')\r\n                            .html(title_img + 'Schedule report');\r\n                    },\r\n                    close: function(event, ui) {\r\n                        $(this).dialog('destroy').remove();\r\n                    }\r\n                });\r\n                dlg.dialog(\"open\");\r\n                $(\"#id_role\" + args.instanceid).select2();\r\n                this.SelectRoleUsers();\r\n                this.schformvalidation({\r\n                    reportid: args.reportid,\r\n                    form: 'schform' + args.instanceid,\r\n                    reqclass: 'schformreq' + args.instanceid,\r\n                    instanceid: args.instanceid\r\n                });\r\n            }).fail(function(ex) {\r\n                // do something with the exception\r\n                //  console.log(ex);\r\n            });\r\n        },\r\n        ScheduledTimings: function(args) {\r\n            $(\"select[data-select2='1']\").select2({\r\n                theme: \"classic\"\r\n            });\r\n            this.SelectRoleUsers();\r\n            $('#scheduledtimings').dataTable({\r\n                \"processing\": true,\r\n                \"serverSide\": true,\r\n                \"lengthMenu\": [\r\n                    [5, 10, 25, 50, -1],\r\n                    [5, 10, 25, 50, \"All\"]\r\n                ],\r\n                \"idisplaylength\": 5,\r\n                'ordering': false,\r\n                \"ajax\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": M.cfg.wwwroot + \"/blocks/learnerscript/components/scheduler/ajax.php\",\r\n                    \"data\": args\r\n                }\r\n            });\r\n        },\r\n        ViewSchUsersTable: function(args) {\r\n            $('#scheduledusers').dataTable({\r\n                \"processing\": true,\r\n                \"serverSide\": true,\r\n                \"lengthMenu\": [\r\n                    [5, 10, 25, 50, -1],\r\n                    [5, 10, 25, 50, \"All\"]\r\n                ],\r\n                \"idisplaylength\": 5,\r\n                'ordering': false,\r\n                \"ajax\": {\r\n                    \"method\": \"GET\",\r\n                    \"url\": M.cfg.wwwroot + \"/blocks/learnerscript/components/scheduler/ajax.php\",\r\n                    \"data\": {\r\n                        action: 'viewschusersdata',\r\n                        reportid: args.reportid,\r\n                        scheduleid: args.scheduleid,\r\n                        schuserslist: args.schuserslist\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * Add validation script to AJAX reponse MOODLE form\r\n         * @param  object args Form name and required classname\r\n         * @return {[type]}      [description]\r\n         */\r\n        schformvalidation: function(args) {\r\n            document.getElementById(args.form).addEventListener('submit', function(ev) {\r\n                try {\r\n                    var myValidator = report.validate_scheduled_reports_form(args);\r\n                } catch (e) {\r\n                    return true;\r\n                }\r\n                if (typeof window.tinyMCE !== 'undefined') {\r\n                    window.tinyMCE.triggerSave();\r\n                }\r\n                if (!myValidator) {\r\n                    ev.preventDefault();\r\n                }\r\n                return false;\r\n            });\r\n        },\r\n        /**\r\n         * Validates and return error message for each element of given form\r\n         * @param  object args Formname and required classname\r\n         * @return Returns list of error messages from validation\r\n         */\r\n        validate_scheduled_reports_form: function(args) {\r\n            var self = this;\r\n            if (skipClientValidation) {\r\n                $('.schreportform' + args.instanceid).dialog('destroy').remove();\r\n            }\r\n            var ret = true;\r\n            var frm = document.getElementById(args.form);\r\n            var first_focus = false;\r\n            $(\"[data-class='\" + args.reqclass + \"']\").each(function(index, value) {\r\n                var element = $(value).data('element');\r\n                ret = self.validate_scheduled_reports_form_element(value, element, args) && ret;\r\n                if (!ret && !first_focus) {\r\n                    first_focus = true;\r\n                    Y.use('moodle-core-event', function() {\r\n                        Y.Global.fire(M.core.globalEvents.FORM_ERROR, {\r\n                            formid: args.form,\r\n                            elementid: 'id_error_' + element + args.instanceid\r\n                        });\r\n                        document.getElementById('id_error_' + element + args.instanceid).focus();\r\n                    });\r\n                }\r\n            });\r\n            return ret;\r\n        },\r\n        /**\r\n         * Format error message string for each element\r\n         * @param  object element Element object\r\n         * @param  string escapedName Element name\r\n         * @return Formatted error messages for each element\r\n         */\r\n        validate_scheduled_reports_form_element: function(element, escapedName, args) {\r\n            if (undefined == element) {\r\n                //required element was not found, then let form be submitted without client side validation\r\n                return true;\r\n            }\r\n            var value = '';\r\n            var errFlag = new Array();\r\n            var _qfGroups = {};\r\n            var _qfMsg = '';\r\n            var frm = element.parentNode;\r\n            if ((undefined != element.name) && (frm != undefined)) {\r\n                while (frm && frm.nodeName.toUpperCase() != 'FORM') {\r\n                    frm = frm.parentNode;\r\n                }\r\n                value = new Array();\r\n                var valueIdx = 0;\r\n                for (var i = 0; i < element.options.length; i++) {\r\n                    if (element.options[i].selected) {\r\n                        value[valueIdx++] = element.options[i].value;\r\n                    }\r\n                }\r\n                if (value == '' && !errFlag[escapedName]) {\r\n                    errFlag[escapedName] = true;\r\n                    _qfMsg = _qfMsg + ' - You must supply a value here.';\r\n                }\r\n                return this.qf_errorHandler(element, _qfMsg, escapedName, args);\r\n            } else {\r\n                //element name should be defined else error msg will not be displayed.\r\n                return true;\r\n            }\r\n        },\r\n        /**\r\n         * Render and display error message for each element\r\n         * @param  object element  Element object\r\n         * @param  string _qfMsg  Error message\r\n         * @param  string escapedName Element name\r\n         * @return Render and display error message for each element\r\n         */\r\n        qf_errorHandler: function(element, _qfMsg, escapedName, args) {\r\n            var event = $.Event(Event.Events.FORM_FIELD_VALIDATION);\r\n            $(element).trigger(event, _qfMsg);\r\n            if (event.isDefaultPrevented()) {\r\n                return _qfMsg == '';\r\n            } else {\r\n                // Legacy mforms.\r\n                var div = element.parentNode;\r\n                if ((div == undefined) || (element.name == undefined)) {\r\n                    // No checking can be done for undefined elements so let server handle it.\r\n                    return true;\r\n                }\r\n                if (_qfMsg != '') {\r\n                    var errorSpan = document.getElementById('id_error_' + escapedName + args.instanceid);\r\n                    if (!errorSpan) {\r\n                        errorSpan = document.createElement('span');\r\n                        errorSpan.id = 'id_error_' + escapedName + args.instanceid;\r\n                        errorSpan.className = 'error';\r\n                        element.parentNode.insertBefore(errorSpan, element.parentNode.firstChild);\r\n                        document.getElementById(errorSpan.id).setAttribute('TabIndex', '0');\r\n                        document.getElementById(errorSpan.id).focus();\r\n                    }\r\n                    while (errorSpan.firstChild) {\r\n                        errorSpan.removeChild(errorSpan.firstChild);\r\n                    }\r\n                    errorSpan.appendChild(document.createTextNode(_qfMsg.substring(3)));\r\n                    if (div.className.substr(div.className.length - 6, 6) != ' error' && div.className != 'error') {\r\n                        div.className += ' error';\r\n                        linebreak = document.createElement('br');\r\n                        linebreak.className = 'error';\r\n                        linebreak.id = 'id_error_break_' + escapedName + args.instanceid;\r\n                        errorSpan.parentNode.insertBefore(linebreak, errorSpan.nextSibling);\r\n                    }\r\n                    return false;\r\n                } else {\r\n                    var errorSpan = document.getElementById('id_error_' + escapedName + args.instanceid);\r\n                    if (errorSpan) {\r\n                        errorSpan.parentNode.removeChild(errorSpan);\r\n                    }\r\n                    var linebreak = document.getElementById('id_error_break_' + escapedName + args.instanceid);\r\n                    if (linebreak) {\r\n                        linebreak.parentNode.removeChild(linebreak);\r\n                    }\r\n                    if (div.className.substr(div.className.length - 6, 6) == ' error') {\r\n                        div.className = div.className.substr(0, div.className.length - 6);\r\n                    } else if (div.className == 'error') {\r\n                        div.className = '';\r\n                    }\r\n                    return true;\r\n                }\r\n            }\r\n        },\r\n        frequency_schedule: function(args) {\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_frequency_schedule',\r\n                args: {\r\n                    frequency: $(\"#id_frequency\" + args.reportinstance).val()\r\n                    // action: 'frequency_schedule'\r\n                }\r\n            }]);\r\n            promise[0].done(function(resp) {\r\n                resp = $.parseJSON(resp);\r\n                var template = '';\r\n                if (resp) {\r\n                    $.each(resp, function(index, value) {\r\n                        template += '<option value = ' + index + ' >' + value + '</option>';\r\n                    });\r\n                } else {\r\n                    template += '<option value=null > --SELECT-- </option>';\r\n                }\r\n                $(\"#id_updatefrequency\" + args.reportinstance).html(template);\r\n            }).fail(function(ex) {\r\n                // do something with the exception\r\n                //  console.log(ex);\r\n            });\r\n        },\r\n        /**\r\n         * Manage more users to schedule report\r\n         * @param  object args reportid,scheduleid,selectedroleid and userslist\r\n         * @return Display popup with manage users for scheduled/Scheduling report\r\n         */\r\n        manageschusers: function(args) {\r\n            Str.get_string('manageschusers','block_learnerscript').then(function(s) {\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_manageschusers',\r\n                args: {\r\n                    // action: 'manageschusers',\r\n                    reportid: args.reportid,\r\n                    scheduleid: args.scheduleid,\r\n                    selectedroleid: JSON.stringify(args.selectedroleid),\r\n                    // selectedroleid: args.selectedroleid,\r\n                    schuserslist: args.schuserslist,\r\n                    reportinstance: args.reportinstance\r\n                }\r\n                // url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\r\n            }]);\r\n\r\n            promise[0].done(function(response) {\r\n                response = $.parseJSON(response);\r\n                $('body').append(\"<div class='manageschusers'>\" + response + \"</div>\");\r\n                var bodyattb = $('body').attr('id');\r\n                var position, my, at;\r\n                if(bodyattb == 'page-blocks-learnerscript-components-scheduler-schedule'){\r\n                    position = '#scheduleform';\r\n                    my = \"center top\";\r\n                    at = \"center top\";\r\n                }else{\r\n                    position = window;\r\n                    my = \"center\";\r\n                    at = \"center\";\r\n                    var cid = $(\".manageschusers\").addClass('notschuserspage');\r\n                }                       \r\n                var dlg = $(\".manageschusers\").dialog({\r\n                    resizable: true,\r\n                    autoOpen: false,\r\n                    width: \"60%\",\r\n                    title: 'Manage Schedule Users',\r\n                    modal: true,\r\n                    position: {\r\n                        my: my,\r\n                        at: at,\r\n                        of: position,\r\n                        within: position\r\n                    },\r\n                    close: function(event, ui) {\r\n                        $(this).dialog('destroy').remove();\r\n                    },\r\n                    open: function() {\r\n                        $(this).closest(\".ui-dialog\")\r\n                            .find(\".ui-dialog-titlebar-close\")\r\n                            .removeClass(\"ui-dialog-titlebar-close\")\r\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        // $(this).closest(\".ui-dialog\")\r\n                        //     .find('.ui-dialog-title').html(title_img + self.args.title);\r\n                    }\r\n                });\r\n                if($(\".manageschusers\").hasClass(\"notschuserspage\")){\r\n                    var parentdialog = $(\".manageschusers\").parent();\r\n                    parentdialog.addClass('notinschpage');\r\n                }\r\n                // dlg.closest(\".ui-dialog\").draggable({containment: \"parent\"});\r\n                $(\".selectrole\" + args.reportid).select2();\r\n                dlg.dialog(\"open\");\r\n            }).fail(function(ex) {\r\n                // do something with the exception\r\n                //  console.log(ex);\r\n            });\r\n        });\r\n        },\r\n        /**\r\n         * Get users for selected roles in bulk user form while searching\r\n         * @param  object args reportid and selected roles\r\n         * @return object List of users for selected roles\r\n         */\r\n        getroleusers: function(args) {\r\n            var roles = $('.selectrole' + args.reportid).val();\r\n            this.validate_scheduled_reports_form({\r\n                reportid: args.reportid,\r\n                form: 'assignform',\r\n                reqclass: 'rolereq'\r\n            });\r\n            var bullkselectedusers = $('.removeselect').val();\r\n            if ($('#addselect_searchtext').val().length < 1) {\r\n                template = \"<optgroup label='Enter a value in search.'></optgroup>\";\r\n                $('#' + args.type + 'select' + args.reportid).html(template);\r\n            } else {\r\n                var roleid = roles.split('_');\r\n                args.roleid = roleid[0];\r\n                args.contextlevel = roleid[1];\r\n                var promise = Ajax.call([{\r\n                    methodname: 'block_learnerscript_roleusers',\r\n                    args: {\r\n                        // action: 'roleusers',\r\n                        term: $('#addselect_searchtext').val(),\r\n                        type: args.type,\r\n                        reportid: args.reportid,\r\n                        roleid: args.roleid,\r\n                        contextlevel: args.contextlevel,\r\n                        scheduleid: args.scheduleid,\r\n                        bullkselectedusers: JSON.stringify(bullkselectedusers)\r\n                    },\r\n                    // url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\r\n                }]);\r\n                promise[0].done(function(response) {\r\n                    var template = '';\r\n                    response = $.parseJSON(response);\r\n                    if (response.total_count > 0) {\r\n                        $.each(response.items, function(index, value) {\r\n                            template += '<option value = ' + value.id + ' >' + value.fullname + '</option>';\r\n                        });\r\n                    } else {\r\n                        template += \"<optgroup label='No results found.'></optgroup>\";\r\n                    }\r\n                    $('#' + args.type + 'select' + args.reportid).html(template);\r\n                }).fail(function(ex) {\r\n                    // do something with the exception\r\n                    // console.log(ex);\r\n                });\r\n            }\r\n        },\r\n        /**\r\n         * Add/remove bulk users to schedule reports\r\n         * @param  object args reportid\r\n         * @return Add/remove users to schedule report form\r\n         */\r\n        bulkmanageschusers: function(args) {\r\n            var bullkselectedusers = $.map($('.removeselect option'), function(e) {\r\n                return e.value;\r\n            });\r\n            $('#schuserslist' + args.reportinstance).val(bullkselectedusers);\r\n            var selectedusers = $('.removeselect').find('option').clone();\r\n            $('#id_users_data' + args.reportinstance).children('option').remove();\r\n            if (selectedusers.length > 10) {\r\n                var tenusers = selectedusers.slice(0, 10);\r\n                tenusers.attr('selected', 'selected').appendTo('#id_users_data' + args.reportinstance);\r\n                var opt = document.createElement('option');\r\n                opt.value = '-1';\r\n                opt.innerHTML = 'View More';\r\n                opt.selected = true;\r\n                document.getElementById('id_users_data' + args.reportinstance).appendChild(opt);\r\n            } else {\r\n                $('.removeselect').find('option').clone().attr('selected', 'selected').appendTo('#id_users_data' + args.reportinstance);\r\n            }\r\n            $('.manageschusers').dialog('close');\r\n        },\r\n        /**\r\n         * Preview selected users to schedule report\r\n         * @param  object args reportid,scheduleid and userslist\r\n         * @return Preview users in dialog\r\n         */\r\n        viewschusers: function(args) {\r\n            Str.get_string('viewschusers','block_learnerscript').then(function(s) {\r\n                var self = this;\r\n                args.schuserslist = $('#schuserslist' + args.reportinstance).val();\r\n                var promise = ajax.call({\r\n                    methodname: 'viewschuserstable',\r\n                    args: {\r\n                        action: 'viewschuserstable',\r\n                        reportid: args.reportid,\r\n                        scheduleid: args.scheduleid,\r\n                        schuserslist: args.schuserslist\r\n                    },\r\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\r\n                });\r\n                promise.done(function(response) {\r\n                    $('body').append(\"<div class='viewschuserstable'>\" + response + \"</div>\");\r\n                    var dlg = $(\".viewschuserstable\").dialog({\r\n                        resizable: true,\r\n                        autoOpen: false,\r\n                        width: \"60%\",\r\n                        title: 'View Scheduled Users',\r\n                        modal: true,\r\n                        close: function(event, ui) {\r\n                            $(this).dialog('destroy').remove();\r\n                        },\r\n                        open: function() {\r\n                            $(this).closest(\".ui-dialog\")\r\n                                .find(\".ui-dialog-titlebar-close\")\r\n                                .removeClass(\"ui-dialog-titlebar-close\")\r\n                                .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                                var Closebutton = $('.ui-icon-closethick').parent();\r\n                                $(Closebutton).attr({\r\n                                    \"title\" : \"Close\"\r\n                                });\r\n                            // $(this).closest(\".ui-dialog\")\r\n                            //     .find('.ui-dialog-title').html(title_img + self.args.title);\r\n                        }\r\n                    });\r\n                    schedule.ViewSchUsersTable(args);\r\n                    dlg.dialog(\"open\").prev(\".ui-dialog-titlebar\").css(\"color\", \"#0C75B6\");\r\n                }).fail(function(ex) {\r\n                    // do something with the exception\r\n                    //console.log(ex);\r\n                });\r\n            });\r\n        },\r\n        /**\r\n         * Add users to schedule report\r\n         * @param  object args reportid\r\n         * @return Adds users to schedule report form\r\n         */\r\n        addschusers: function(args) {\r\n            var selschusers = $('.schforms' + args.reportinstance + ' #id_users_data' + args.reportinstance).val();\r\n            var selusers = $('.schforms' + args.reportinstance + ' #schuserslist' + args.reportinstance).val();\r\n            var total;\r\n            if (selusers) {\r\n                selusers = selusers.split(',');\r\n                total = selusers.concat(selschusers);\r\n            } else {\r\n                total = selschusers;\r\n            }\r\n            if (total && total.includes('-1')) {\r\n                var index = total.indexOf('-1');\r\n                total.splice(index, 1);\r\n            }\r\n            $('#id_users_data' + args.reportinstance).find('option').not(':selected').each(function(k, v) {\r\n                if (total && total.includes(v.value)) {\r\n                    var index = total.indexOf(v.value);\r\n                    total.splice(index, 1);\r\n                }\r\n            });\r\n            var d = total && total.filter(function(item, pos) {\r\n                return total.indexOf(item) == pos;\r\n            });\r\n            $('#schuserslist' + args.reportinstance).val(d);\r\n        },\r\n        /**\r\n         * Get roleusers for selected report\r\n         */\r\n        SelectRoleUsers: function() {\r\n            var reportid = $(\".schform\").data('reportid');\r\n            require(['block_learnerscript/helper'], function(helper) {\r\n                helper.Select2Ajax({\r\n                    reportid: reportid,\r\n                    action: 'rolewiseusers',\r\n                    maximumSelectionLength: 10\r\n                });\r\n            })\r\n        },\r\n        rolewiseusers: function(args) {\r\n            $('#id_users_data' + args.reportinstance).val(null).trigger('change');\r\n        }\r\n    }\r\n});"],"file":"schedule.min.js"}