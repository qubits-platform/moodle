"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[489],{51124:function(e,n,t){var s=t(41799),i=t(85893),o=t(67294),a=t(21737),r=o.forwardRef(function(e,n){return(0,i.jsx)(a.Z,(0,s.Z)({elevation:6,ref:n,variant:"filled"},e))});n.Z=r},83489:function(e,n,t){t.r(n),t.d(n,{default:function(){return es}});var s,i,o,a,r,l,u,d=t(47568),c=t(828),p=t(97582),f=t(85893),h=t(67294),g=t(87357),m=t(98456),b=t(74981);t(4007),t(89899),t(56395),t(44151);var y=t(82222),_=void 0;sqlite3InitModule({print:console.log,printErr:console.error}).then(function(e){_=e});var v=(s=(0,d.Z)(function(e,n){var t,s,i,o,a;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return t=function(){var n=[],t="";return e.split("").forEach(function(e,s){if("\n"===e||"\r"===e){t+=" ";return}t+=e,";"===e&&(n.push(t.trim()),t="")}),console.log(n),n},[4,x()];case 1:return s=new(r.sent()).oo1.DB("/data.db","cw"),i=function(){try{var e="";t().forEach(function(n){if(!n.startsWith("--")){var t=n.split(/\s/).slice(0,1)[0].toLowerCase();if("create"==t){s.exec(n);var i="Created Table successfully<br>";console.log(void 0===i?"undefined":(0,y.Z)(i)),e+=i}else if("insert"==t)s.exec(n),e+="Inserted Data Successfully<br>";else if("select"==t||"pragma"==t){var o=[],a=[];s.exec({sql:n,rowMode:"object",resultRows:o,columnNames:a});var r=a.map(function(e){return'<th class="sql-table-style">'.concat(e,"</th>")}).join(""),l=o.map(function(e){var n=Object.values(e).map(function(e){return'<td class="sql-table-style">'.concat(e,"</td>")}).join("");return"<tr>".concat(n,"</tr>")}).join("");if(0==o.length)e+="Data not exist<br>";else{var u="<div><table class='table table-bordered'>\n            <thead><tr>".concat(r,"</tr></thead>\n            <tbody>").concat(l,"</tbody></table></div>");e+=u}}else"delete"==t&&(s.exec(n),e+="Deleted Data Successfully<br>")}}),n(e)}catch(e){for(var i=e.message.split(":"),o="",a=0;a<i.length;a++)o+=i[a];n(o)}},-1!=(o=e.split("\n")[0]).search("DATA")&&o.startsWith("--")?(a=o.split(":")[1].trim(),k("./".concat(a),{headers:{"Content-Type":"text/plain"},method:"GET"}).then(function(e){return e.text()}).then(function(e){e.split("\n").forEach(function(e){if(""!==(e=e.trim()))try{s.exec(e)}catch(e){console.log(e.message)}})}).then(function(){i()}).catch(function(e){return alert("Unable to load data file: "+e.message)})):i(),[2]}})}),function(e,n){return s.apply(this,arguments)}),k=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e3;return Promise.race([fetch(e,n),new Promise(function(e,n){return setTimeout(function(){return n(Error("timeout"))},t)})])},x=(i=(0,d.Z)(function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:if(_)return[2,_];return[4,new Promise(function(e){return setTimeout(e,5e3)}).then(function(){if(!_)throw Error("Sqlite didnt initialize.. reload your browser and try");return _})];case 1:return e.sent(),[2]}})}),function(){return i.apply(this,arguments)}),w="",N=["Python initialization complete",'File "/',"CodeRunner","mod = compile","self.ast"],S=(o=(0,d.Z)(function(e){var n;return(0,p.__generator)(this,function(t){switch(t.label){case 0:return""!=w&&(w=""),n=function(n){return I(n,e)},[4,loadPyodide({stdout:n})];case 1:return[2,t.sent()]}})}),function(e){return o.apply(this,arguments)}),j=(a=(0,d.Z)(function(e,n,t){var s,i,o;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,S(n)];case 1:s=a.sent(),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,s.loadPackagesFromImports(e)];case 3:return i=a.sent(),[4,s.runPythonAsync(e)];case 4:return(i=a.sent())?F(i,n):""!==w?F(i,n):n(""),t(!0),[3,6];case 5:return o=a.sent(),t(!0),I(o.message,n),[3,6];case 6:return[2]}})}),function(e,n,t){return a.apply(this,arguments)});function I(e,n){e.split("\n").forEach(function(e){N.some(function(n){return e.includes(n)})||F(e,n)})}function F(e,n){e&&n(w+=e+"\n")}var C=(r=(0,d.Z)(function(e,n,t){return(0,p.__generator)(this,function(s){return j(e,n,t),[2]})}),function(e,n,t){return r.apply(this,arguments)}),P=(l=(0,d.Z)(function(e,n,t){var s,i;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),[4,loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.21.3/full/"})];case 1:return[4,(s=o.sent()).loadPackage("micropip")];case 2:return o.sent(),[4,s.pyimport("micropip").install("https://cdn.jsdelivr.net/gh/qubits-platform/pytutor@master/dist/pytutor-1.0.0-py3-none-any.whl")];case 3:return o.sent(),[4,s.runPythonAsync('import json\nfrom pytutor import generate_trace\ncode = """\n'.concat(e,'\n"""\ntrace = generate_trace.run_logger(code, "")\ntrace_dict = json.loads(trace)\njson.dumps(trace_dict, indent=2)\n'))];case 4:return(i=o.sent())&&(t(""),n(JSON.parse(i))),[3,6];case 5:return console.log(o.sent()),[3,6];case 6:return[2]}})}),function(e,n,t){return l.apply(this,arguments)}),Z=(u=(0,d.Z)(function(e,n,t){return(0,p.__generator)(this,function(s){return P(e,n,t),[2]})}),function(e,n,t){return u.apply(this,arguments)}),R=t(20637);function T(e){var n=e.content,t=e.language,s=t?R.Z.highlight(t,n):R.Z.highlightAuto(n);return(0,f.jsx)("pre",{className:"hljs",children:(0,f.jsx)("code",{className:"language-".concat(t," hljs"),dangerouslySetInnerHTML:{__html:s.value}})})}var O=t(51438),L=t(52951),E=function(){function e(n){(0,O.Z)(this,e),this.workerURL=n,this.worker=null,this.isRunning=!1,this.isSuspended=!1,this.maxTimeout=180,this.timeoutId=-1,this.outputBuffer="",this.sharedOutput=!1,this.dbgCurrentLine=null,this.preLoadedPackages=[],this.onError=null,this.onOutput=null,this.onInput=null,this.onFigure=null,this.onTimeout=null,this.onDirtyFile=null,this.onReceivePyFile=null,this.onStatusUpdate=null,this.onTerminated=null,this.commands={}}return(0,L.Z)(e,[{key:"addCommand",value:function(e,n){this.commands[e]=n}},{key:"stop",value:function(){null!=this.worker&&(this.worker.terminate(),this.worker=null,this.isRunning=!1,this.onTerminated&&this.onTerminated())}},{key:"create",value:function(){var e=this;this.stop();try{this.worker=new Worker(t.tu(new URL(t.p+t.u(70),t.b)))}catch(e){console.log(e);var n,s="data://application/javascript,".concat((n=this.workerURL,'importScripts("'.concat(n,'");')),";");this.worker=new Worker(s)}this.isRunning=!1,this.worker.addEventListener("message",function(n){var t,s,i,o,a,r,l,u;switch(n.data.cmd){case"print":e.printToOutput(n.data.data);break;case"clear":e.clearOutput();break;case"figure":null===(t=e.onFigure)||void 0===t||t.call(e,n.data.data);break;case"dirty":null===(s=e.onDirtyFile)||void 0===s||s.call(e,n.data.data);break;case"file":null===(i=e.onReceivePyFile)||void 0===i||i.call(e,n.data.path,n.data.data);break;case"input":e.isRunning=!1,e.webworkerStatus="input",null===(o=e.onStatusChanged)||void 0===o||o.call(e,"input"),null===(a=e.onInput)||void 0===a||a.call(e,n.data.prompt);break;case"status":e.webworkerStatus=n.data.status,null===(r=e.onStatusChanged)||void 0===r||r.call(e,e.webworkerStatus);break;case"done":e.isRunning=!1,e.isSuspended=null!=n.data.suspendedAt,e.dbgCurrentLine=n.data.suspendedAt,e.webworkerStatus="idle",null===(l=e.onStatusChanged)||void 0===l||l.call(e,"done"),null===(u=e.onTerminated)||void 0===u||u.call(e);break;default:"cmd:"===n.data.cmd.slice(0,4)&&e.commands[n.data.cmd.slice(4)]&&e.commands[n.data.cmd.slice(4)](n.data.data)}}),this.worker.addEventListener("error",function(n){e.onError?e.onError(n):console.info(n)});var i={cmd:"config",options:{handleInput:!0,inlineInput:this.sharedOutput,preLoadedPackages:this.preLoadedPackages}};console.log("preloaded packages in PyWorker: ",this.preLoadedPackages),this.worker.postMessage(JSON.stringify(i))}},{key:"handleTimeout",value:function(){var e=this;this.maxTimeout>=0&&(this.timeoutId>=0&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){e.isRunning&&(e.stop(),e.onStatusChanged&&e.onStatusChanged("timeout"),e.onTimeout&&e.onTimeout()),e.timeoutId=-1},1e3*this.maxTimeout))}},{key:"run",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(null==this.worker||this.isRunning)&&this.create(),this.worker.postMessage(JSON.stringify(null!=e?{cmd:"run",code:e,breakpoints:n}:{cmd:"preload"})),this.isRunning=!0,this.handleTimeout()}},{key:"submitInput",value:function(e){this.worker&&!this.isRunning&&(this.worker.postMessage(JSON.stringify({cmd:"submit",str:e})),this.isRunning=!0,this.handleTimeout())}},{key:"cancelInput",value:function(){this.worker&&!this.isRunning&&(this.worker.postMessage(JSON.stringify({cmd:"cancel"})),this.webworkerStatus="",this.onStatusChanged&&this.onStatusChanged(""))}},{key:"dbgResume",value:function(e){this.worker&&this.isSuspended&&(this.worker.postMessage(JSON.stringify({cmd:"debug",dbg:e})),this.isRunning=!0,this.handleTimeout())}},{key:"getFile",value:function(e){var n;null===(n=this.worker)||void 0===n||n.postMessage(JSON.stringify({cmd:"get",path:e}))}},{key:"putFile",value:function(e,n){var t;null===(t=this.worker)||void 0===t||t.postMessage(JSON.stringify({cmd:"put",path:e,data:n}))}},{key:"preload",value:function(){this.run(null)}},{key:"clearOutput",value:function(){this.sharedOutput||(this.outputBuffer=""),this.onOutput&&this.onOutput("",!1)}},{key:"clearFigure",value:function(){var e;null===(e=this.worker)||void 0===e||e.postMessage(JSON.stringify({cmd:"clearFigure"}))}},{key:"printToOutput",value:function(e){this.sharedOutput?this.onOutput&&this.onOutput(e,!0):(this.outputBuffer+=e,this.onOutput&&this.onOutput(this.outputBuffer,!1))}}]),e}(),q=function(e,n){try{var t=M(function(){Function(e)()});n(t)}catch(e){n("Error: ".concat(e.message))}},M=function(e){var n=console.log,t="";return console.log=function(e){t+=e+"\n"},e(),console.log=n,t},A=(0,t(90948).ZP)("textarea")(function(e){return e.theme,{fontFamily:"monospace",width:"100%",resize:"none",height:"auto",borderWidth:"0px",color:"inherit",backgroundColor:"inherit","&:focus-visible":{outline:"none"}}}),D=function(e){var n=e.prompt,t=e.readOnly,s=e.onValidate,i=e.setprompt;(0,h.useEffect)(function(){l(o),(null==u?void 0:u.current)&&(u.current.style.height="auto",u.current.style.height="".concat(u.current.scrollHeight,"px"),u.current.focus(),u.current.setSelectionRange(n.length,n.length))},[n,t]);var o="",a=(0,c.Z)((0,h.useState)(o),2),r=a[0],l=a[1],u=(0,h.useRef)(null),d=(0,h.useRef)(null);return(0,f.jsx)("div",{ref:d,children:(0,f.jsx)(A,{readOnly:t,ref:u,onChange:function(e){l(e.target.value.slice(n.length))},onKeyDown:function(e){"Enter"===e.key&&(l(o),s(r),i(""))},value:"".concat(n).concat(r),"data-gramm_editor":"false",spellCheck:"false"})})},U=function(e){var n=e.isWaitingForInput,t=e.prompt,s=e.onClickValidateInput,i=e.setPrompt,o=e.output;return(0,f.jsx)("div",{className:"resultTextareaStyle w-100",children:(0,f.jsx)(D,{onValidate:s,prompt:o+(n?t:""),readOnly:!n,setprompt:i})})},B=t(31536),G=t(8135),z=t(15861),V=t(69417),W=t(70655),J=t(34282),H=t(94613),Y=function(e){var n=e.reset,t=e.visualization,s=e.runCode,i=e.handleReset,o=e.runPythonTutor,a=e.value,r=e.language,l=e.uniqID,u=e.setRawInputLst;return(0,f.jsx)(g.Z,{spacing:3,className:"button-toolbar",children:(0,f.jsxs)(B.Z,{direction:"row",gap:1,sx:{justifyContent:"flex-end"},children:[(0,f.jsx)(G.Z,{title:(0,f.jsx)(z.Z,{fontSize:12,children:"Run"}),placement:"top",children:(0,f.jsx)(V.Z,{variant:"outlined",endIcon:(0,f.jsx)(W.Z,{}),onClick:function(){return s(a,r)},className:"tool-button"})}),n&&(0,f.jsx)(G.Z,{title:(0,f.jsx)(z.Z,{fontSize:12,children:"Reset"}),placement:"top",children:(0,f.jsx)(V.Z,{variant:"outlined",endIcon:(0,f.jsx)(J.Z,{}),onClick:function(){i(l),u([])},className:"tool-button"})}),t&&(0,f.jsx)(G.Z,{title:(0,f.jsx)(z.Z,{fontSize:12,children:"Debug"}),placement:"top",children:(0,f.jsx)(V.Z,{variant:"outlined",endIcon:(0,f.jsx)(H.Z,{}),onClick:function(){return o(a)},className:"tool-button"})})]})})},K=function(e){var n=e.hint,t=e.parsedHints,s=e.showFixedCode,i=e.language,o=e.errorCatch,a=e.PageLoader;return(0,f.jsx)(f.Fragment,{children:n.hints?(0,f.jsx)("div",{className:"ai-console-wrapper",children:(0,f.jsxs)("div",{className:"resultTextareaStyleerror",children:[" ",(0,f.jsx)(V.Z,{variant:"outlined",className:"chatgptbtn",onClick:function(){return runfixedCode()},children:"Fix Code"})," ",(0,f.jsx)("div",{className:"hintstyle",children:"object"==typeof t?(0,f.jsx)("ul",{children:null==t?void 0:t.map(function(e,n){return(0,f.jsx)("li",{children:e},n)})}):"string"==typeof t&&(0,f.jsx)("ul",{children:(0,f.jsx)("li",{children:t})})}),(0,f.jsx)("br",{}),s&&(0,f.jsx)("div",{children:(0,f.jsx)(b.ZP,{mode:i,highlightActiveLine:!1,value:n.fixedCode,maxLines:50,showGutter:!1,fontSize:14,editorProps:{$blockScrolling:!1},width:"100%",readOnly:!0,height:"100%"})})," "]})}):o&&(0,f.jsx)(a,{})})},$=t(25935),Q=function(e){var n=e.sqlTableOutput,t=e.output,s=e.input,i=e.consoleReset,o=e.language;return(0,f.jsx)(f.Fragment,{children:n?t&&!s&&i&&(0,f.jsx)("code",{className:"sqlTableStyle",readOnly:!0,children:"python"===o?(0,f.jsx)("pre",{children:t}):(0,$.ZP)(t)}):t&&!s&&i&&(0,f.jsx)("code",{className:"resultTextareaStyle w-100",readOnly:!0,children:"python"===o?(0,f.jsx)("pre",{children:t}):(0,$.ZP)(t)})})},X=t(93946),ee=t(51124),en=t(57922),et=function(e){var n=e.traceBlock,t=e.pytutorReset,s=e.errorMsg,i=e.handleCloseAlert,o=e.consoleReset,a=e.showAlert,r=e.uniqID;return(0,f.jsxs)(f.Fragment,{children:[n&&t&&s&&(0,f.jsx)("div",{id:"TraceBlock"+r,children:(0,f.jsx)(ee.Z,{sx:{marginTop:"10px"},severity:"error",action:(0,f.jsx)(X.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){return i()}}),children:s})}),o&&(0,f.jsx)("div",{className:"alert-collapse",children:(0,f.jsx)(en.Z,{in:a,sx:{mt:2},children:(0,f.jsx)(ee.Z,{severity:"error",action:(0,f.jsx)(X.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){return i()}}),children:s})})})]})};function es(e){var n,s=e.dataChage,i=e.value,o=e.language,a=e.editable,r=e.uniqID,l=e.input,u=e.handleReset,y=e.visualization,_=e.reset,k=e.className,x=e.gutter,w=e.pytutorReset,N=e.setpytutorReset,S=e.theme,j=e.consoleReset,I=e.setConsoleReset,F=(0,c.Z)((0,h.useState)(null),2),P=F[0],R=F[1],O=(0,c.Z)((0,h.useState)(""),2),L=O[0],M=O[1],A=(0,c.Z)((0,h.useState)(!1),2),D=A[0],B=A[1],G=(0,c.Z)((0,h.useState)(!1),2),z=G[0],V=G[1];(0,h.useEffect)(function(){if(l){var e=t(52135),n=new E(e);R(n),n.onOutput=function(e){$(e)},n.onInput=function(e){B(!0),M(e)}}return function(){V(!1)}},[l]);var W=function(e){P.run(e),P.clearOutput(),V(!0)},J=(0,c.Z)((0,h.useState)(""),2),H=J[0],$=J[1],X=(0,c.Z)((0,h.useState)(""),2),ee=X[0],en=X[1],es=(0,c.Z)((0,h.useState)(!1),2),ei=es[0],eo=es[1],ea=(0,c.Z)((0,h.useState)(!1),2),er=(ea[0],ea[1]),el=(0,c.Z)((0,h.useState)(!1),2),eu=el[0],ed=el[1],ec=(0,c.Z)((0,h.useState)(""),2),ep=ec[0],ef=ec[1],eh=(0,c.Z)((0,h.useState)(!1),2),eg=eh[0];eh[1];var em=(0,c.Z)((0,h.useState)(!1),2),eb=em[0],ey=em[1],e_=(0,c.Z)((0,h.useState)(""),2),ev=e_[0],ek=e_[1],ex=(0,c.Z)((0,h.useState)(),2),ew=ex[0];ex[1];var eN=(0,c.Z)((0,h.useState)(!1),2),eS=(eN[0],eN[1]),ej=(0,c.Z)((0,h.useState)(!0),2),eI=ej[0];ej[1];var eF=(0,c.Z)((0,h.useState)(!1),2),eC=eF[0],eP=eF[1],eZ=(0,c.Z)((0,h.useState)([]),2),eR=eZ[0],eT=eZ[1],eO=(n=(0,d.Z)(function(e,n){return(0,p.__generator)(this,function(t){return eo(!0),ed(!1),ef(""),$("Running..."),ek(""),ey(!1),"python"!==n||(l&&(I(!0),W(e),eS(!0),er(!0)),l||(I(!0),C(e,$,eS))),"sql"===n&&(I(!0),v(e,$),eS(!0)),"javascript"===n&&(I(!0),q(e,$)),eo(!1),[2]})}),function(e,t){return n.apply(this,arguments)});(0,h.useEffect)(function(){var e,n,t,s;!ee||(null===(e=ee.trace)||void 0===e?void 0:e[0].exception_msg)?ee&&(null===(n=ee.trace)||void 0===n?void 0:n[0].exception_msg)&&(eo(!1),ek(null===(s=ee.trace)||void 0===s?void 0:s[0].exception_msg),ey(!0)):(t=new ExecutionVisualizer("TraceBlock"+r,ee,{debugMode:!1,showAllFrameLabels:!0,lang:"py3",highlightLines:!0,arrowLines:!1,verticalStack:!0,inputCode:i,setTrackBlock:en,setOutput:$,rawInputLst:eR}),eo(!1),t.redrawConnectors(),"\n\n"===t.sourceFiles.main_code&&ek("Error Occurred while trying to get visualization. Please retry"))},[ee]),(0,h.useEffect)(function(){""!==eR&&eT([])},[s]),(0,h.useEffect)(function(){H&&H.search("Traceback")&&er(!0)},[H]),(0,h.useEffect)(function(){},[ep]),(0,h.useEffect)(function(){H.match(/<thead>/gi)?(eP(!0),eS(!1)):eP(!1)},[H]);var eL=function(){return(0,f.jsx)(g.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mt:2},children:(0,f.jsx)(m.Z,{})})};return(0,f.jsxs)("div",{className:"editor-container",children:[!a&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(b.ZP,{mode:o,highlightActiveLine:!1,id:1,value:i,maxLines:50,showGutter:x,fontSize:14,editorProps:{$blockScrolling:!1},onChange:s,width:"100%",readOnly:a,height:"100%",className:k,theme:S?"crimson_editor":"",setOptions:{useWorker:!1}})}),a&&(0,f.jsx)(T,{language:o,content:i}),(0,f.jsx)(Y,{reset:_,visualization:y,runCode:eO,handleReset:u,runPythonTutor:function(e){ek(""),N(!0),ey(!1),eo(!0),ed(!1),Z(e,en,$)},value:i,language:o,uniqID:r,setRawInputLst:eT}),(l&&z||H&&!l)&&(0,f.jsxs)("div",{className:"console-wrapper",children:[l&&z&&(0,f.jsx)(U,{isWaitingForInput:D,prompt:L,onClickValidateInput:function(e){P&&(P.submitInput(e),B(!1))},setPrompt:M,output:H}),(0,f.jsx)(Q,{sqlTableOutput:eC,output:H,input:l,consoleReset:j,language:o})]}),eu&&j&&(0,f.jsx)(K,{hint:ep,parsedHints:ew,showFixedCode:eg,language:o,errorCatch:eI,PageLoader:eL}),ee&&!eu&&!ev&&w&&(0,f.jsx)("div",{id:"TraceBlock"+r,className:"traceBlockStyle w-100"}),ei&&(0,f.jsx)(eL,{}),(0,f.jsx)(et,{traceBlock:ee,pytutorReset:w,errorMsg:ev,handleCloseAlert:function(){ey(!1)},consoleReset:j,showAlert:eb,uniqID:r})]})}},52135:function(e,n,t){t.r(n);var s=t(51438),i=t(52951),o=t(28668),a=t(41357),r=t(76296),l="https://cdn.jsdelivr.net/pyodide/v0.21.3/full/",u=function(){function e(){(0,s.Z)(this,e)}return(0,i.Z)(e,null,[{key:"create",value:function(){return self.sessionStorage?new c:new d}}]),e}(),d=function(e){(0,o.Z)(t,e);var n=(0,r.Z)(t);function t(){var e;return(0,s.Z)(this,t),(e=n.call(this)).fs={},(0,a.Z)(e)}return(0,i.Z)(t,[{key:"getDir",value:function(){return Object.keys(this.fs)}},{key:"getFile",value:function(e){return this.fs[e]}},{key:"setFile",value:function(e,n){this.fs[e]=n}}]),t}(u),c=function(e){(0,o.Z)(t,e);var n=(0,r.Z)(t);function t(){return(0,s.Z)(this,t),n.apply(this,arguments)}return(0,i.Z)(t,[{key:"getDir",value:function(){return Object.keys(self.sessionStorage)}},{key:"getFile",value:function(e){return self.sessionStorage.getItem(e)}},{key:"setFile",value:function(e,n){self.sessionStorage.setItem(e,n)}}]),t}(u),p=function(){function e(n){(0,s.Z)(this,e),this.pyodide=null,this.postExec=n&&n.postExec||function(){},this.write=n&&n.write||function(e){},this.clearText=n&&n.clearText||function(){},this.setFigureURL=n&&n.setFigureURL||function(e){},this.notifyDirtyFile=n&&n.notifyDirtyFile||function(e){},this.notifyStatus=n&&n.notifyStatus||function(e){},this.handleInput=n&&n.handleInput||!1,this.inlineInput=n&&n.inlineInput||!1,this.pyodideURL=n&&n.pyodideURL||l;var t=/\/(v[\d.]+)\//.exec(this.pyodideURL);this.pyodideVersion=t?t[1]:"",this.requestInput=!1,this.inputPrompt=null,this.suspended=!1,this.dbgCurrentLine=null,this.preLoadedPackages=null==n?void 0:n.preLoadedPackages,this.requestedModuleNames=[],this.loadedModuleNames=[],this.failedModuleNames=[],this.fs=u.create(),this.dirtyFiles=[]}return(0,i.Z)(e,[{key:"load",value:function(e){var n=this;this.notifyStatus("loading Pyodide "+this.pyodideVersion),globalThis.loadPyodide({indexURL:this.pyodideURL}).then(function(t){n.pyodide=t,n.pyodideVersion=t.version,n.notifyStatus("setup"),self.pyodideGlobal={requestModule:function(e){return n.requestModule(e)},fs:n.fs,markFileDirty:function(e){return n.markFileDirty(e)},setDbgCurrentLine:function(e){n.dbgCurrentLine=e}},n.preLoadedPackages.forEach(function(e){n.notifyStatus("pre-loading "+e),n.pyodide.loadPackage(e).then(function(){n.loadedModuleNames.push(e),n.notifyStatus(e+" pre-loaded")}).catch(function(t){n.failedModuleNames.push(e),n.notifyStatus("error pre-loading "+e+t)})}),n.pyodide.runPython('\n                import sys\n                import io\n                from js import pyodideGlobal\n\n                class __ImportIntercept:\n                    def find_spec(self, name, path, module):\n                        pyodideGlobal.requestModule(name)\n                sys.meta_path.append(__ImportIntercept())\n\n                class MyTextFile(io.StringIO):\n                    def __init__(self, filename, mode="r"):\n                        self.filename = filename\n                        self.readOnly = mode == "r"\n                        content = pyodideGlobal.fs.getFile(filename)\n                        if content is None:\n                            if self.readOnly:\n                                raise FileNotFoundError(filename)\n                            content = ""\n                        else:\n                            if mode == "w":\n                                content = ""\n                            elif mode == "x":\n                                raise FileExistsError(filename)\n                        super().__init__(content if content is not None else "")\n                        if mode == "a":\n                            self.seek(0, 2)\n                    def close(self):\n                        if not self.readOnly:\n                            content = self.getvalue()\n                            pyodideGlobal.fs.setFile(self.filename, content)\n                            pyodideGlobal.markFileDirty(self.filename)\n                            super().close()\n\n                def open(filename, mode="r", encoding=None):\n                    return MyTextFile(filename, mode)\n\n                import os\n\n                def __os_listdir(path="."):\n                    return list(pyodideGlobal.fs.getDir())\n                os.listdir = __os_listdir\n\n                # user code execution\n                global_variables = {\n                    "open": open,\n                    "input": input\n                }\n\n                # global debugger\n                dbg = None\n\n                def execute_code(src, breakpoints=None):\n                    """Return 0 if done, 1 if suspended in debugger, 2 if waiting for input"""\n\n                    class Dbg:\n\n                        import sys\n                        import os\n                        import re\n\n                        class Suspended(Exception):\n                            pass\n\n                        class SuspendedForInput(Suspended):\n                            pass\n\n                        def __init__(self, interactive=True):\n                            self.interactive = interactive\n                            self.frame = None\n\n                            # breakpoint line numbers\n                            self.breakpoints = set()\n                            self.break_at_start = True\n                            # past actions or inputs from the user\n                            # ("c"=continue, "n"=next, "s"=step, "r"=return, etc.)\n                            # resume will execute them and suspend execution when they are exhausted\n                            self.debug_action_history = []\n                            # True to ignore trace calls until 2nd event="call"\n                            self.ignore_top_call = False\n                            # substitution for input global function\n                            self.input_debug = None\n\n                            self.last_command = ""\n\n                            self.init_output()\n                            self.null = open(self.os.devnull, "w")\n\n                        def init_output(self):\n                            self.stdout = self.sys.stdout\n                            self.stderr = self.sys.stderr\n\n                        def enable_print(self, on):\n                            self.sys.stdout = self.stdout if on else self.null\n                            self.sys.stderr = self.stderr if on else self.null\n\n                        def clear_breakspoints(self):\n                            self.breakpoints = set()\n\n                        def set_breakpoint(self, lineno):\n                            self.breakpoints.add(lineno)\n\n                        def clear_breakspoint(self, lineno):\n                            self.breakpoints.remove(lineno)\n\n                        def is_suspended(self):\n                            return self.frame is not None\n\n                        def is_requesting_input(self):\n                            return self.request_input\n\n                        def debug_(self, fun, ignore_top_call, args, kwargs):\n                            self.fun = fun\n                            self.args = args\n                            self.kwargs = kwargs\n                            self.ignore_top_call = ignore_top_call\n                            self.returned_value = None\n                            self.debug_action_history = []\n                            self.resume(None)\n                            if self.interactive:\n                                self.cli()\n\n                        def debug_call(self, fun, *args, **kwargs):\n                            self.debug_(fun, False, args, kwargs)\n\n                        def debug_code(self, code, globals=globals(), locals=None):\n                            def input(prompt):\n                                return self.input_debug(prompt)\n                            globals["input"] = input\n                            self.debug_(lambda: exec(code, globals, locals), True, (), {})\n\n                        def resume(self, cmd):\n                            if cmd is not None:\n                                self.debug_action_history.append(cmd)\n\n                            # state ("s"=step, "n"=next, "r"=return, "c"=continue)\n                            state = "s" if self.break_at_start else "c"\n                            # index of first action in self.debug_action_history to perform\n                            action_count = 0\n                            # call depth used for "n" and "r"\n                            call_depth = 0\n                            last_break_depth = 0\n                            # number of event "call"\n                            call_count = 0\n\n                            def trace(frame, event, arg):\n                                nonlocal state, action_count, call_depth, last_break_depth, call_count\n                                if self.ignore_top_call:\n                                    if event == "call":\n                                        if frame.f_code.co_name == "input":\n                                            if action_count >= len(self.debug_action_history):\n                                                # call to input(prompt): display prompt and request user input\n                                                if frame.f_locals["prompt"] is not None:\n                                                    self.sys.stdout.write(frame.f_locals["prompt"])\n                                                self.frame = frame\n                                                raise self.SuspendedForInput()\n                                            else:\n                                                # execute input() defined below (picks input in self.debug_action_history)\n                                                pass\n                                        call_count += 1\n                                        call_depth += 1\n                                    if call_count < 2:\n                                        return\n                                if event == "line":\n                                    self.current_line = frame.f_lineno\n                                    if (state == "n" and call_depth <= last_break_depth or\n                                        state == "r" and call_depth < last_break_depth or\n                                        state == "s" or\n                                        frame.f_lineno in self.breakpoints):\n                                        # breakpoint (explicit, or following s/n/r which should break here)\n                                        if action_count >= len(self.debug_action_history):\n                                            # not reached yet: really break here\n                                            self.frame = frame\n                                            raise self.Suspended()\n                                        else:\n                                            # already reached: continue\n                                            state = self.debug_action_history[action_count]\n                                            action_count += 1\n                                            last_break_depth = call_depth\n                                            if action_count >= len(self.debug_action_history):\n                                                self.enable_print(True)\n                                    elif action_count >= len(self.debug_action_history):\n                                        self.enable_print(True)\n                                elif event == "call":\n                                    call_depth += 1\n                                elif event == "return":\n                                    call_depth -= 1\n                                return trace\n\n                            def input(prompt):\n                                nonlocal action_count\n                                str = self.debug_action_history[action_count]\n                                action_count += 1\n                                return str\n                            self.input_debug = input\n\n                            suspended = False\n                            self.request_input = False\n                            self.enable_print(len(self.debug_action_history) <= 1)\n                            self.sys.settrace(trace)\n                            try:\n                                self.returned_value = self.fun(*self.args, **self.kwargs)\n                            except self.SuspendedForInput:\n                                suspended = True\n                                self.request_input = True\n                            except self.Suspended:\n                                suspended = True\n                            finally:\n                                self.sys.settrace(None)\n                                self.enable_print(True)\n                            if not suspended:\n                                self.frame = None\n\n                        def eval_code(self, src):\n                            try:\n                                code = compile(src, "<stdin>", "single")\n                                exec(code,\n                                     self.frame.f_globals,\n                                     self.frame.f_locals)\n                            except Exception as e:\n                                import traceback\n                                traceback.print_exception(etype=type(e),\n                                                          value=e,\n                                                          tb=e.__traceback__)\n\n                        def exec_cmd(self, cmd):\n                            cmd = cmd.strip() or self.last_command\n                            r = self.re.compile(r"^(S+)(s+(S+))$")\n                            match = r.match(cmd)\n                            if match:\n                                cmd0 = match.groups()[0]\n                                arg = match.groups()[2]\n                            else:\n                                cmd0 = cmd\n                                arg = None\n                            if cmd0 in ["b", "break"]:\n                                if arg is None:\n                                    print(self.breakpoints)\n                                else:\n                                    try:\n                                        lineno = int(arg)\n                                        self.set_breakpoint(lineno)\n                                    except:\n                                        print("Bad line number")\n                                self.last_command = ""\n                            elif cmd in ["c", "continue"]:\n                                self.resume("c")\n                                self.last_command = cmd\n                            elif cmd0 in ["cl", "clear"]:\n                                if arg:\n                                    try:\n                                        lineno = int(arg)\n                                        self.clear_breakspoint(lineno)\n                                    except:\n                                        print("Bad line number")\n                                else:\n                                    self.clear_breakspoints()\n                                self.last_command = ""\n                            elif cmd in ["h", "help"]:\n                                import textwrap\n                                print(textwrap.dedent("""\n                                    b(reak) line  break at specified line\n                                    c(ontinue)    continue\n                                    cl(ear)       clear all breakpoints\n                                    h(elp)        help\n                                    q(quit)       quit\n                                    r(eturn)      continue until the current function returns\n                                    s(tep)        step\n                                    w(here)       display a stack trace\n                                    expr          evaluate expression, including local and global variables\n                                    """))\n                                self.last_command = ""\n                            elif cmd in ["q", "quit"]:\n                                self.frame = None\n                            elif cmd in ["n", "next"]:\n                                self.resume("n")\n                                self.last_command = cmd\n                            elif cmd in ["r", "return"]:\n                                self.resume("r")\n                                self.last_command = cmd\n                            elif cmd in ["s", "step"]:\n                                self.resume("s")\n                                self.last_command = cmd\n                            elif cmd in ["w", "where"]:\n                                frame = self.frame\n                                while frame and (frame.f_code.co_name != "resume"):\n                                    print(f"{frame.f_code.co_name} at line {frame.f_lineno}")\n                                    frame = frame.f_back\n                            elif cmd != "":\n                                self.eval_code(cmd)\n\n                            # return true when execution is completed\n                            return self.frame is None\n\n                        def submit_input(self, input):\n                            self.debug_action_history.append(input)\n                            self.resume(None)\n\n                        def cli(self):\n                            while self.is_suspended():\n                                cmd = input(f"{self.frame.f_code.co_name}:{self.frame.f_lineno} dbg> ")\n                                self.exec_cmd(cmd)\n\n                    try:\n                        code = compile(src, "<stdin>", mode="single")\n                    except SyntaxError:\n                        code = compile(src, "<stdin>", mode="exec")\n\n                    if breakpoints:\n                        global dbg\n                        dbg = Dbg(False)\n                        dbg.break_at_start = False;\n                        for breakpoint in breakpoints:\n                            dbg.set_breakpoint(breakpoint)\n                        dbg.debug_code(code, globals=global_variables)\n                        return 0 if not dbg.is_suspended() else 2 if dbg.request_input else 1\n                    else:\n                        exec(code, global_variables)\n                        return 0\n\n                def continue_debugging(dbg_command):\n                    if dbg is not None and dbg.is_suspended():\n                        dbg.init_output()  # can be a new io.StringIO() object\n                        dbg.exec_cmd(dbg_command)\n                        return 0 if not dbg.is_suspended() else 2 if dbg.request_input else 1\n\n                def submit_input_to_debugger(input):\n                    if dbg is not None and dbg.is_suspended() and dbg.request_input:\n                        dbg.init_output()  # can be a new io.StringIO() object\n                        dbg.submit_input(input)\n                        return 0 if not dbg.is_suspended() else 2 if dbg.request_input else 1\n\n                def debug_current_line():\n                    return dbg.current_line if dbg and dbg.is_suspended() else None\n            '),e&&e()})}},{key:"requestModule",value:function(e){0>this.requestedModuleNames.indexOf(e)&&0>this.loadedModuleNames.indexOf(e)&&0>this.failedModuleNames.indexOf(e)&&this.requestedModuleNames.push(e)}},{key:"markFileDirty",value:function(e){0>this.dirtyFiles.indexOf(e)&&(this.dirtyFiles.push(e),this.notifyDirtyFile(e))}},{key:"getDirtyFilePaths",value:function(e){var n=this.dirtyFiles;return e&&(this.dirtyFiles=[]),n}},{key:"run",value:function(e,n){var t=this;if(""===e.trim())return!0;this.pyodide.runPython("\n            import io, sys\n            sys.stdout = io.StringIO()\n            sys.stderr = sys.stdout\n        "),this.loadedModuleNames.indexOf("matplotlib")>=0&&this.pyodide.runPython('\n                import matplotlib\n                matplotlib.use("Agg")\n            '),this.handleInput&&this.pyodide.runPython('\n                class CodeWithInputEvaluator:\n\n                    def __init__(self, src, global_variables):\n\n                        import ast\n\n                        def check_node(node, block_reason=None):\n                            """Check that input function is called only from where it is supported,\n                            i.e. at top-level if block_reason is None, not in functions or methods, and\n                            nowhere if block_reason is a string describing the offending context. Raise\n                            an exception otherwise.\n                            """\n                            if type(node) is ast.ClassDef:\n                                block_reason = "class"\n                            elif type(node) is ast.FunctionDef:\n                                block_reason = "def"\n                            elif type(node) is ast.Lambda:\n                                block_reason = "lambda"\n                            elif block_reason and type(node) is ast.Call and type(node.func) is ast.Name and node.func.id == "input":\n                                raise Exception(f"input call not supported in {block_reason} at line {node.lineno}")\n                            for child in ast.iter_child_nodes(node):\n                                check_node(child, block_reason)\n\n                        def check(src):\n                            """Check that input function is called only from where it is supported,\n                            i.e. at top-level, not in functions or methods. Raise an exception otherwise.\n                            """\n                            root = ast.parse(src)\n                            check_node(root)\n\n                        def replace_input_with_yield(src, function_name, global_var_names=[]):\n\n                            """Compile source code and replace input calls with yield.\n                            """\n                            class Replacer(ast.NodeTransformer):\n                                """NodeTransformer which replaces input(prompt) with\n                                yield((False,prompt,locals()))\n                                """\n                                def visit_Call(self, node):\n                                    self.generic_visit(node)\n                                    if type(node.func) is ast.Name and node.func.id == "input":\n                                        input_arg = node.args[0] if len(node.args) > 0 else ast.NameConstant(value=None)\n                                        y = ast.Yield(value=ast.Tuple(\n                                            elts=[\n                                                ast.NameConstant(value=False),\n                                                input_arg,\n                                                ast.Call(func=ast.Name(id="locals", ctx=ast.Load()), args=[], keywords=[])\n                                            ],\n                                            ctx=ast.Load()\n                                        ))\n                                        return y\n                                    return node\n\n                            # compile to ast\n                            root = ast.parse(src)\n\n                            # check that input is called only from top-level code, not functions\n                            check_node(root)\n\n                            # replace input(prompt) with yield (False,prompt,locals())\n                            replacer = Replacer()\n                            root1 = replacer.visit(root)\n\n                            # replace last statement with "import sys; sys.displayhook(expr)" if it is an expr\n                            last_el = root1.body[-1]\n                            if type(last_el) is ast.Expr:\n                                expr = root1.body.pop()\n                                root1.body.append(ast.Import(\n                                    names=[\n                                        ast.alias(name="sys", asname=None)\n                                    ]\n                                ))\n                                root1.body.append(ast.Expr(\n                                    value=ast.Call(\n                                        func=ast.Attribute(attr="displayhook", value=ast.Name(id="sys", ctx=ast.Load()), ctx=ast.Load()),\n                                        args=[expr.value],\n                                        keywords=[]\n                                    )\n                                ))\n\n                            # append yield (True,None,locals())\n                            y = ast.Expr(\n                                value=ast.Yield(value=ast.Tuple(\n                                    elts=[\n                                        ast.NameConstant(value=True),\n                                        ast.NameConstant(value=None),\n                                        ast.Call(func=ast.Name(id="locals", ctx=ast.Load()), args=[], keywords=[])\n                                    ],\n                                    ctx=ast.Load()\n                                ))\n                            )\n                            root1.body.append(y)\n\n                            # define a coroutine\n                            root1.body = [\n                                ast.FunctionDef(\n                                    name=function_name,\n                                    args=ast.arguments(\n                                        posonlyargs=[],\n                                        args=[ast.arg(arg=g, annotation=None) for g in global_var_names],\n                                        defaults=[],\n                                        kwarg=None,\n                                        kw_defaults=[],\n                                        kwonlyargs=[],\n                                        vararg=None\n                                    ),\n                                    body=root1.body,\n                                    decorator_list=[],\n                                    returns=None\n                                )\n                            ]\n\n                            # add dummy missing lineno and col_offset to make compiler happy\n                            for node in ast.walk(root1):\n                                if not hasattr(node, "lineno"):\n                                    node.lineno = 1\n                                if not hasattr(node, "col_offset"):\n                                    node.col_offset = 999\n\n                            # compile\n                            code = compile(root1, "<ast>", "exec")\n\n                            return code\n\n                        def run_code_with_input_as_coroutine(src, global_variables):\n                            code = replace_input_with_yield(src, "corout", global_variables)\n                            gl = {}\n                            exec(code, gl)\n                            co = gl["corout"](**global_variables)\n                            return co\n\n                        self.global_variables = global_variables\n                        self.co = run_code_with_input_as_coroutine(src, global_variables)\n                        self.done, self.prompt, new_global_variables = self.co.send(None)\n                        self.global_variables.update(new_global_variables)\n\n                    def submit_input(self, input):\n                        self.done, self.prompt, new_global_variables = self.co.send(input)\n                        self.global_variables.update(new_global_variables)\n\n                    def cancel_input(self):\n                        self.co.close()\n            ');var s="";this.requestedModuleNames=[],this.suspended=!1,this.dbgCurrentLine=null;try{if(this.notifyStatus("running"),self.pyodideGlobal.setFigureURL=function(e){return t.setFigureURL(e)},this.pyodide.globals.set("src",e),n&&n.length>0){var i="["+n.map(function(e){return e.toString(10)}).join(", ")+"]";this.pyodide.runPython("\n                    import js\n                    status = execute_code(src, breakpoints=".concat(i,")\n                    suspended = status != 0\n                    done = not suspended\n                    js.pyodideGlobal.setDbgCurrentLine(debug_current_line())\n                ")),this.suspended=this.pyodide.globals.get("suspended"),this.requestInput=2===this.pyodide.globals.get("status"),this.inputPrompt=null}else this.handleInput?(this.pyodide.runPython("evaluator = CodeWithInputEvaluator(src, global_variables)"),this.requestInput=!1,this.pyodide.runPython("\n                    done = evaluator.done\n                    suspended = False\n                    # suspended = evaluator.suspended\n                    input_prompt = evaluator.prompt\n                "),this.pyodide.globals.get("done")||this.pyodide.globals.get("suspended")||(this.inputPrompt=this.pyodide.globals.get("input_prompt"),this.requestInput=!0)):this.pyodide.runPython("execute_code(src); done = True; suspended = False");this.loadedModuleNames.indexOf("matplotlib")>=0&&this.pyodide.runPython('\n                    import matplotlib.pyplot, io, base64, js\n                    if matplotlib.pyplot.get_fignums():\n                        with io.BytesIO() as buf:\n                            matplotlib.pyplot.savefig(buf, format="png")\n                            buf.seek(0)\n                            js.pyodideGlobal.setFigureURL("data:image/png;base64," +\n                                base64.b64encode(buf.read()).decode("ascii"))\n                ')}catch(n){if(/ModuleNotFoundError/.test(n.message)&&this.requestedModuleNames.length>0){var o=this.requestedModuleNames.shift();return this.notifyStatus("loading module "+o),this.pyodide.loadPackage(o).then(function(){t.loadedModuleNames.push(o),t.notifyStatus("running"),t.run(e)}).catch(function(){t.failedModuleNames.push(o),t.postExec&&t.postExec()}),!1}s=n.message,this.pyodide.globals.set("done",!0)}var a=this.pyodide.runPython("sys.stdout.getvalue()");return this.write(a+s),this.pyodide.globals.get("done")||this.pyodide.globals.get("suspended")||!this.inlineInput||this.write(null==this.inputPrompt?"? ":this.inputPrompt),this.postExec&&this.postExec(),!0}},{key:"submitInput",value:function(e){if(this.requestInput){this.pyodide.runPython("\n                import io, sys\n                sys.stdout = io.StringIO()\n                sys.stderr = sys.stdout\n            "),this.inlineInput||this.write((null==this.inputPrompt?"? ":this.inputPrompt)+e+"\n"),this.requestInput=!1,self.input_string=e;var n="";if(this.suspended)try{this.pyodide.runPython("\n                        import js\n                        status = submit_input_to_debugger(js.input_string)\n                        suspended = status != 0\n                        done = not suspended\n                        js.pyodideGlobal.setDbgCurrentLine(debug_current_line())\n                    "),this.suspended=this.pyodide.globals.get("suspended"),this.requestInput=2==this.pyodide.globals.get("status"),this.inputPrompt=null}catch(e){}else try{this.pyodide.runPython("\n                        import js\n                        evaluator.submit_input(js.input_string)\n                        done = evaluator.done\n                        # suspended = evaluator.suspended\n                        input_prompt = evaluator.prompt\n                    "),this.pyodide.globals.get("done")||this.pyodide.globals.get("suspended")||(this.inputPrompt=this.pyodide.globals.get("input_prompt"),this.requestInput=!0)}catch(e){n=e.message,this.pyodide.globals.set("done",!0)}var t=this.pyodide.runPython("sys.stdout.getvalue()");this.write(t+n),this.pyodide.globals.get("done")||this.pyodide.globals.get("suspended")||!this.inlineInput||this.write(null==this.inputPrompt?"? ":this.inputPrompt),this.postExec&&this.postExec()}}},{key:"cancelInput",value:function(){if(this.requestInput){this.requestInput=!1;try{this.pyodide.runPython("evaluator.cancel_input()")}catch(e){}this.dbgCurrentLine=null}}},{key:"continueDebugging",value:function(e){this.pyodide.runPython("import io, syssys.stdout = io.StringIO()sys.stderr = sys.stdout");try{self.dbg_command=e,this.pyodide.runPython("\n                import js\n                status = continue_debugging(js.dbg_command)\n                suspended = status != 0\n                done = not suspended\n                js.pyodideGlobal.setDbgCurrentLine(debug_current_line())\n            "),this.suspended=this.pyodide.globals.get("suspended"),this.requestInput=2==this.pyodide.globals.get("status"),this.inputPrompt=null}catch(e){}var n=this.pyodide.runPython("sys.stdout.getvalue()");this.write(n),this.pyodide.globals.get("done")||this.pyodide.globals.get("suspended")||!this.inlineInput||this.write(null==this.inputPrompt?"? ":this.inputPrompt),this.postExec&&this.postExec()}},{key:"clearFigure",value:function(){this.loadedModuleNames.indexOf("matplotlib")>=0&&(this.pyodide.runPython("\n                import matplotlib.pyplot\n                matplotlib.pyplot.close()\n            "),this.setFigureURL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="))}},{key:"clear",value:function(){this.clearText(),this.clearFigure()}}]),e}(),f=!1,h=!1,g="",m=-1,b=null;function y(e,n){postMessage({cmd:"status",status:n&&n.length>0?"debugging":"running"}),b.run(e,n)}onmessage=function(e){var n,t,s=function(e){var n={write:function(e){g+=e},clearText:function(){g="",h=!0},setFigureURL:function(e){postMessage({cmd:"figure",data:e})},notifyStatus:function(e){postMessage({cmd:"status",status:e})},notifyDirtyFile:function(e){postMessage({cmd:"dirty",data:e})},postExec:function(){var e;(m=e=Date.now())<0?m=e+10:m<=e&&(h&&(postMessage({cmd:"clear"}),h=!1),g&&(postMessage({cmd:"print",data:g}),g=""),m=-1),postMessage({cmd:"done",suspendedAt:b.suspended?b.dbgCurrentLine:null}),b.requestInput&&postMessage({cmd:"input",prompt:b.inputPrompt})},handleInput:e&&e.handleInput||!1,inlineInput:e&&e.inlineInput||!1,preLoadedPackages:(null==e?void 0:e.preLoadedPackages)||[],pyodideURL:l};console.log("options inside worker: ",n),b=new p(n)},i=JSON.parse(e.data);if("config"===i.cmd)s(i.options);else switch(null==b&&s(),i.cmd){case"preload":postMessage({cmd:"status",status:"startup"}),b.load(function(){f=!0,postMessage({cmd:"done"})});break;case"run":f?y(i.code,i.breakpoints):(postMessage({cmd:"status",status:"startup"}),b.load(function(){y(i.code,i.breakpoints),f=!0}));break;case"submit":n=i.str,b.submitInput(n,t);break;case"cancel":b.cancelInput();break;case"debug":if(f&&b.suspended)switch(i.dbg){case"next":case"step":case"return":case"continue":case"quit":b.continueDebugging(i.dbg)}else postMessage({cmd:"done"});break;case"get":postMessage({cmd:"file",path:i.path,data:b.fs.getFile(i.path)});break;case"put":b.fs.setFile(i.path,i.data);break;case"clearFigure":b.clearFigure()}}}}]);